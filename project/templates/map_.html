<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>æ¢ç´¢åœ°åœ– - å‹•ç‰©ç ”ç©¶é™¢</title>
  <link rel="stylesheet" href="../css/styles.css">
  <link rel="stylesheet" href="../css/map.css">
</head>
<body>
  <div class="hp-container">
    <div class="hp-top-area">
      <div class="hp-top-left">
        <div class="hp-title">å‹•ç‰©ç ”ç©¶é™¢</div>
        <div class="control-button">  <!--è²éŸ³icon-->
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#A0522D" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
            <path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>
            <path d="M19.07 4.93a10 10 0 0 1 0 14.14"></path>
          </svg>
        </div>
        <div class="control-button">  <!--è³‡è¨Šicon-->
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#A0522D" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="8" x2="12" y2="12"></line>
            <line x1="12" y1="16" x2="12.01" y2="16"></line>
          </svg>
        </div>
      </div>
      <div class="hp-top-right">
       <div class="player-info">ç ”ç©¶é»æ•¸: 000</div>

        <div class="control-button">  <!--è¨­å®šicon-->
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#A0522D" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="3"></circle>
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
          </svg>
        </div>
      </div>
    </div>
    
    <!-- ä¸»è¦å…§å®¹å€åŸŸ -->
    <div class="hp-main-content">
      <!-- å·¦å´èœå–® -->
      <div class="left-menu">
        <div class="menu-item">
          <span class="menu-icon">ğŸ“–</span>
          <span>ä¸»ç·šåŠ‡æƒ…</span>
        </div>
        <div class="menu-item">
          <span class="menu-icon">ğŸ¦Š</span>
          <span>å‹•ç‰©åœ–é‘‘</span>
        </div>
        <div class="menu-item active">
          <span class="menu-icon">ğŸ¾</span>
          <span>æ¢ç´¢åœ°åœ–</span>
        </div>
        <div class="menu-item">
          <span class="menu-icon">ğŸ§ª</span>
          <span>ç ”ç©¶å¯¦é©—å®¤</span>
        </div>
        <div class="menu-item">
          <span class="menu-icon">ğŸ†</span>
          <span>æˆå°±ç³»çµ±</span>
        </div>
        <div class="menu-item">
          <span class="menu-icon">ğŸ’</span>
          <span>ç‰©å“èƒŒåŒ…</span>
        </div>
      </div>
      
            <!-- ä¸­å¿ƒå…§å®¹å€ -->
      <div class="center-content">
        <div class="page-container">
          <h2 class="map-title">æ¢ç´¢åœ°åœ–</h2>
          <div class="zones">
            <!-- é€£é€£çœ‹éŠæˆ²å€åŸŸ -->
            <div class="zone">
              <div class="zone-image">ğŸŒ³</div>
              <h3>æ£®æ—å€åŸŸ</h3>
              <p>åœ¨é€™è£¡ä½ å¯ä»¥æ¢ç´¢æ£®æ—ä¸­çš„å„ç¨®å‹•ç‰©ï¼Œä¸¦é€šéé€£é€£çœ‹éŠæˆ²ä¾†å­¸ç¿’ç‰ å€‘çš„åç¨±ã€‚</p>
              <a href="game1.html" class="game-btn">é€²å…¥éŠæˆ²</a>
            </div>
            
            <!-- æ‰¾ä¸åŒéŠæˆ²å€åŸŸ -->
            <div class="zone">
              <div class="zone-image">ğŸŒŠ</div>
              <h3>æµ·æ´‹å€åŸŸ</h3>
              <p>æ¢ç´¢æµ·æ´‹ç”Ÿç‰©çš„å¥§ç§˜ï¼Œé€šéæ‰¾ä¸åŒéŠæˆ²ä¾†è¨“ç·´ä½ çš„è§€å¯ŸåŠ›ã€‚</p>
              <a href="game2.html" class="game-btn">é€²å…¥éŠæˆ²</a>
              <div class="locked-overlay">
                <div>
                  <div class="lock-icon">ğŸ”’</div>
                  <div>éœ€è¦å®Œæˆæ£®æ—å€åŸŸ</div>
                </div>
              </div>
            </div>
            
            <!-- è¿·å®®éŠæˆ²å€åŸŸ -->
            <div class="zone">
              <div class="zone-image">ğŸ”ï¸</div>
              <h3>å±±åœ°å€åŸŸ</h3>
              <p>ç©¿è¶Šå±±åœ°è¿·å®®ï¼Œå°‹æ‰¾çç¨€å‹•ç‰©ï¼Œä¸¦å­¸ç¿’ç‰ å€‘çš„ç”Ÿå­˜æŠ€èƒ½ã€‚</p>
              <a href="game3.html" class="game-btn">é€²å…¥è¿·å®®éŠæˆ²</a>
              <div class="locked-overlay">
                <div>
                  <div class="lock-icon">ğŸ”’</div>
                  <div>éœ€è¦å®Œæˆæµ·æ´‹å€åŸŸ</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
    </div>
  </div>

  <script src="../js/menu_click.js"></script>
  <script>class GameProgressSystem {
      constructor() {
        this.gameData = {
          forest: { 
            id: 'forest', 
            completed: false, 
            unlocked: true,
            name: 'æ£®æ—å€åŸŸ',
            icon: 'ğŸŒ³',
            description: 'åœ¨é€™è£¡ä½ å¯ä»¥æ¢ç´¢æ£®æ—ä¸­çš„å„ç¨®å‹•ç‰©ï¼Œä¸¦é€šéé€£é€£çœ‹éŠæˆ²ä¾†å­¸ç¿’ç‰ å€‘çš„åç¨±ã€‚',
            gameType: 'é€£é€£çœ‹',
            reward: {
              points: 100,
              item: 'æ£®æ—æ¢ç´¢è­‰æ›¸',
              unlock: 'æµ·æ´‹å€åŸŸ'
            }
          },
          ocean: { 
            id: 'ocean', 
            completed: false, 
            unlocked: false,
            name: 'æµ·æ´‹å€åŸŸ',
            icon: 'ğŸŒŠ',
            description: 'æ¢ç´¢æµ·æ´‹ç”Ÿç‰©çš„å¥§ç§˜ï¼Œé€šéæ‰¾ä¸åŒéŠæˆ²ä¾†è¨“ç·´ä½ çš„è§€å¯ŸåŠ›ã€‚',
            gameType: 'æ‰¾ä¸åŒ',
            reward: {
              points: 150,
              item: 'æµ·æ´‹ç”Ÿç‰©å­¸å®¶å¾½ç« ',
              unlock: 'å±±åœ°å€åŸŸ'
            }
          },
          mountain: { 
            id: 'mountain', 
            completed: false, 
            unlocked: false,
            name: 'å±±åœ°å€åŸŸ',
            icon: 'ğŸ”ï¸',
            description: 'ç©¿è¶Šå±±åœ°è¿·å®®ï¼Œå°‹æ‰¾çç¨€å‹•ç‰©ï¼Œä¸¦å­¸ç¿’ç‰ å€‘çš„ç”Ÿå­˜æŠ€èƒ½ã€‚',
            gameType: 'è¿·å®®',
            reward: {
              points: 200,
              item: 'ç™»å±±å°ˆå®¶è­‰æ›¸',
              unlock: 'æ¥µåœ°å€åŸŸ'
            }
          },
          polar: { 
            id: 'polar', 
            completed: false, 
            unlocked: false,
            name: 'æ¥µåœ°å€åŸŸ',
            icon: 'â„ï¸',
            description: 'æ¢ç´¢æ¥µåœ°å‹•ç‰©çš„é©æ‡‰èƒ½åŠ›ï¼Œé€šéæ‹¼åœ–éŠæˆ²äº†è§£ç‰ å€‘çš„ç”Ÿå­˜ç­–ç•¥ã€‚',
            gameType: 'æ‹¼åœ–',
            reward: {
              points: 250,
              item: 'æ¥µåœ°ç ”ç©¶å“¡å‹³ç« ',
              unlock: 'å…¨å€åŸŸè§£é–'
            }
          }
        };
        
        this.playerProgress = {
          researchPoints: 0,
          completedGames: [],
          achievements: []
        };
        
        this.loadProgress();
        this.renderZones();
        this.updateUI();
      }
      
      loadProgress() {
        const saved = JSON.parse(localStorage.getItem('animalResearchProgress') || '{}');
        if (saved.playerProgress) {
          this.playerProgress = { ...this.playerProgress, ...saved.playerProgress };
          
          // æ ¹æ“šå®Œæˆçš„éŠæˆ²æ›´æ–°è§£é–ç‹€æ…‹
          this.playerProgress.completedGames.forEach(gameId => {
            this.gameData[gameId].completed = true;
            this.unlockNextGame(gameId);
          });
        }
      }
      
      saveProgress() {
        const saveData = {
          playerProgress: this.playerProgress,
          lastSaved: new Date().toISOString()
        };
        localStorage.setItem('animalResearchProgress', JSON.stringify(saveData));
      }
      
      unlockNextGame(completedGameId) {
        const gameOrder = ['forest', 'ocean', 'mountain', 'polar'];
        const currentIndex = gameOrder.indexOf(completedGameId);
        
        if (currentIndex >= 0 && currentIndex < gameOrder.length - 1) {
          const nextGameId = gameOrder[currentIndex + 1];
          this.gameData[nextGameId].unlocked = true;
        }
      }
      
      completeGame(gameId) {
        if (!this.playerProgress.completedGames.includes(gameId)) {
          this.gameData[gameId].completed = true;
          this.playerProgress.completedGames.push(gameId);
          
          const reward = this.gameData[gameId].reward;
          this.playerProgress.researchPoints += reward.points;
          
          // è§£é–ä¸‹ä¸€å€‹éŠæˆ²
          this.unlockNextGame(gameId);
          
          // æ·»åŠ æˆå°±
          this.playerProgress.achievements.push({
            name: reward.item,
            earnedAt: new Date().toISOString(),
            gameId: gameId
          });
          
          this.saveProgress();
          this.renderZones();
          this.updateUI();
          
          // é¡¯ç¤ºå®Œæˆæç¤º
          this.showCompletionMessage(gameId);
        }
      }
      
      showCompletionMessage(gameId) {
        const game = this.gameData[gameId];
        const reward = game.reward;
        
        alert(`ğŸ‰ æ­å–œå®Œæˆ ${game.name}ï¼\n\nç²å¾—çå‹µï¼š\nâ€¢ ç ”ç©¶é»æ•¸ +${reward.points}\nâ€¢ ${reward.item}\nâ€¢ è§£é–ï¼š${reward.unlock}`);
      }
      
      renderZones() {
        const container = document.getElementById('gameZones');
        container.innerHTML = '';
        
        Object.values(this.gameData).forEach(game => {
          const zone = document.createElement('div');
          zone.className = `zone ${game.completed ? 'completed' : ''} ${!game.unlocked ? 'locked' : ''}`;
          
          zone.innerHTML = `
            <div class="zone-image">${game.icon}</div>
            ${game.completed ? '<div class="achievement-badge">ğŸ†</div>' : ''}
            <h3>${game.name}</h3>
            <p>${game.description}</p>
            
            ${game.completed ? `
              <div class="progress-info">
                <p class="progress-text">âœ… å·²å®Œæˆ</p>
                <div class="reward-display">ç²å¾—ï¼š${this.gameData[game.id].reward.item}</div>
              </div>
            ` : ''}
            
            ${game.unlocked ? `
              <button class="game-btn" onclick="gameSystem.startGame('${game.id}')">
                ${game.completed ? 'é‡æ–°æŒ‘æˆ°' : 'é€²å…¥' + game.gameType + 'éŠæˆ²'}
              </button>
            ` : ''}
            
            ${!game.unlocked ? `
              <div class="locked-overlay">
                <div>
                  <div class="lock-icon">ğŸ”’</div>
                  <div>éœ€è¦å®Œæˆå‰ä¸€é—œå¡</div>
                </div>
              </div>
            ` : ''}
          `;
          
          container.appendChild(zone);
        });
      }
      
      startGame(gameId) {
        const game = this.gameData[gameId];
        const modal = document.getElementById('gameModal');
        
        document.getElementById('gameTitle').textContent = `${game.name} - ${game.gameType}éŠæˆ²`;
        document.getElementById('gameDescription').textContent = `æ­£åœ¨é€²è¡Œ${game.gameType}éŠæˆ²...`;
        
        modal.style.display = 'flex';
        
        // å„²å­˜ç•¶å‰éŠæˆ²IDä¾›å®Œæˆæ™‚ä½¿ç”¨
        this.currentGameId = gameId;
      }
      
      updateUI() {
        document.getElementById('pointsValue').textContent = this.playerProgress.researchPoints;
      }
    }
    
    // å…¨åŸŸå‡½æ•¸
    let gameSystem;
    
    document.addEventListener('DOMContentLoaded', function() {
      gameSystem = new GameProgressSystem();
    });
    
    function closeGame() {
      document.getElementById('gameModal').style.display = 'none';
    }
    
    function completeGame() {
      if (gameSystem.currentGameId) {
        gameSystem.completeGame(gameSystem.currentGameId);
        closeGame();
      }
    }
    
    // é‡ç½®é€²åº¦åŠŸèƒ½ï¼ˆæ¸¬è©¦ç”¨ï¼‰
    function resetProgress() {
      if (confirm('ç¢ºå®šè¦é‡ç½®æ‰€æœ‰é€²åº¦å—ï¼Ÿ')) {
        localStorage.removeItem('animalResearchProgress');
        location.reload();
      }
    }
    
    // åœ¨æ§åˆ¶å°è¼¸å…¥ resetProgress() å¯ä»¥é‡ç½®é€²åº¦
    console.log('è¼¸å…¥ resetProgress() å¯ä»¥é‡ç½®éŠæˆ²é€²åº¦');
  </script>
</body>
</html>